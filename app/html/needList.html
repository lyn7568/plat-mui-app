<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>我的需求</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link href="../css/iconfont.css" rel="stylesheet" />
		<link href="../css/app.css" rel="stylesheet" />
	</head>

	<body>
		<header class="mui-bar mui-bar-nav toptitbox">
		    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left topback"></a>
		    <h1 class="mui-title toptit">我发布的需求</h1>
		    <span class="mui-pull-right topsave" id="needIssue">发需求</span>
		</header>
		<div class="mui-content"></div>
		
		<script src="../js/public/mui.min.js"></script>
		<script src="../js/public/base.js"></script>
		<script type="text/javascript">
			//启用双击监听
			mui.init({
				subpages:[{
					url:'needList_sub.html',
					id:'needList_sub.html',
					styles:{
						top: '44px',
						bottom: '0px',
					}
				}]
			});
			/*点击按钮*/
			mui.plusReady(function(){
				document.getElementById("needIssue").addEventListener('tap', function() {
					var $status=["0","1"];
					mui.ajax(baseUrl+"/ajax/demand/qc",{//查询是否有发布中和已过期的需求
						type:"get",
						data:{
							state:$status,
							uid:plus.storage.getItem('userid')
						},
						async:true,
						datatype:"json",
						traditional: true,
						success:function(data){
							console.log(JSON.stringify(data))
							var statusN=data.data;
							if(statusN!=0){
								mui.openWindow({
									url: '../html/demandPublish.html',
									id: '../html/demandPublish.html',
									show: {
										aniShow: "slide-in-right"
									}
								});
							}else{ 
								mui.openWindow({
									url: '../html/sureOrg.html',
									id: 'sureOrg.html',
									show: {
										aniShow: "slide-in-right"
									}
								});
							}
						},
						error: function() {
							plus.nativeUI.toast("服务器链接超时", toastStyle);
							return;
						}
					})
				});
			})
		</script>
	</body>

</html>